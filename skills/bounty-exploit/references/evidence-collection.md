# Evidence Collection Guide

Reference for bounty-exploit skill. Patterns for capturing and organizing evidence.

## Screenshot Capture

### Playwright (preferred)

Use `browser_take_screenshot` MCP tool after navigating to the vulnerable page:

1. `browser_navigate` to the target URL
2. Interact as needed to trigger the vulnerability
3. `browser_take_screenshot` to capture the state

Save screenshots to `findings/FINDING-NNN-<slug>/evidence/`.

### Manual Screenshots

If playwright is unavailable, use `cutycapt` or `wkhtmltoimage`:

```bash
cutycapt --url=<target> --out=evidence/<finding-slug>-screenshot-01.png
```

## HTTP Request/Response Capture

### Full Capture with curl

```bash
curl -v -H "X-Bug-Bounty: True" \
  -H "Cookie: session=<token>" \
  "<target-url>" \
  2>&1 | tee evidence/<finding-slug>-request-01.txt
```

For POST requests:

```bash
curl -v -X POST -H "X-Bug-Bounty: True" \
  -H "Content-Type: application/json" \
  -d '{"param": "value"}' \
  "<target-url>" \
  2>&1 | tee evidence/<finding-slug>-request-01.txt
```

### HAR Capture (complex interactions)

Use playwright for multi-step exploits:

1. `browser_navigate` to starting page
2. Perform steps (click, fill, etc.)
3. `browser_network_requests` to capture request log

Save network log to `evidence/<finding-slug>-har-01.json`.

## Video / Multi-step Evidence

For complex multi-step exploits, capture a sequence of screenshots:

1. `<finding-slug>-step-01.png` -- initial state
2. `<finding-slug>-step-02.png` -- after injecting payload
3. `<finding-slug>-step-03.png` -- vulnerability triggered
4. `<finding-slug>-step-04.png` -- impact demonstrated

Create a `steps.md` narrative alongside the screenshots.

## File Naming Convention

```
<finding-slug>-<type>-<number>.<ext>
```

Types:
- `screenshot` -- browser screenshot
- `request` -- HTTP request/response text
- `har` -- HAR network capture
- `step` -- multi-step screenshot sequence
- `response` -- raw response body

Examples:
- `xss-login-screenshot-01.png`
- `sqli-search-request-01.txt`
- `ssrf-internal-har-01.json`
- `idor-profile-step-03.png`

## Evidence Integrity

Hash every evidence file immediately after capture:

```bash
sha256sum <file> | awk '{print "{\"file\": \"" FILENAME "\", \"sha256\": \"" $1 "\", \"timestamp\": \"" strftime("%Y-%m-%dT%H:%M:%SZ") "\"}"}'
```

Or simpler -- append to manifest manually:

```jsonl
{"file": "xss-login-screenshot-01.png", "sha256": "abc123...", "timestamp": "2026-02-18T12:00:00Z"}
```

Append each entry to `findings/FINDING-NNN-<slug>/evidence-manifest.jsonl`.

## Redaction Checklist

Before including evidence in reports:

- [ ] Personal access tokens removed or masked (`Bearer eyJ...REDACTED`)
- [ ] Other users' PII masked (email, name, phone)
- [ ] Session cookies masked (keep first/last 4 chars: `sess_abcd...wxyz`)
- [ ] Internal IP addresses: OK to show if they demonstrate SSRF impact
- [ ] API keys for researcher's own accounts: mask them
- [ ] Target URLs: keep full -- needed for reproduction

## Evidence Sufficiency Checklist

Per finding, ensure you have:

- [ ] At least one screenshot showing the vulnerability triggered
- [ ] Full HTTP request that triggers the vuln (copy-pasteable by triager)
- [ ] Full HTTP response showing the vulnerability indicator
- [ ] For multi-step: complete sequence from start to impact
- [ ] CVSS vector string justified by the evidence
