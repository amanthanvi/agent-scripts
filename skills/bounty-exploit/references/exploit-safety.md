# Exploitation Safety Guardrails

Reference for bounty-exploit skill. Mandatory rules for all exploitation activity.

## Hard Rules (NEVER violate)

1. **NEVER exceed program financial limits** -- if the program says "no transactions over $1", do not test with $1.01
2. **NEVER modify production data** -- create test accounts where the program allows; otherwise read-only PoCs
3. **NEVER access other researchers' data** -- if you encounter another researcher's test data, stop and move on
4. **NEVER perform denial of service** -- even accidental; limit all payloads to single-request impact
5. **NEVER exfiltrate real user data** -- demonstrate access exists, do not download/store PII
6. **NEVER pivot to internal infrastructure** beyond what's needed for PoC (SSRF: show access, don't enumerate)
7. **NEVER test physical security or wireless** without explicit written authorization

## Required Headers

All HTTP requests during exploitation MUST include program-required headers. Check `admin/roe.md` for specifics.

Common patterns:
- `X-Bug-Bounty: True`
- `X-HackerOne-Research: <username>`
- Custom `User-Agent` string identifying researcher

## PII / Sensitive Data Encounter

If you encounter PII, financial data, health records, or other sensitive information during exploitation:

1. **STOP exploitation immediately**
2. Note the finding (vuln exists, impact is data access)
3. Do NOT capture the sensitive data as evidence
4. Use generic description: "Accessed user profile data including email and phone number"
5. Screenshot with PII masked/blurred
6. Report the vulnerability class and access level, not the data itself

## PoC Minimality

One PoC per finding. The goal is minimum viable proof:

- **XSS**: `alert(document.domain)` or DOM manipulation -- not cookie theft
- **SQLi**: `SELECT version()` or `SELECT 1` -- not `SELECT * FROM users`
- **SSRF**: Access metadata endpoint or internal IP -- not full port scan
- **RCE**: `id` or `whoami` -- not reverse shell
- **IDOR**: Access ONE other resource -- not enumerate all resources
- **Auth bypass**: Access ONE protected endpoint -- not full session hijack

Do not escalate beyond what's necessary to demonstrate the vulnerability exists and has impact.

## Audit Logging

All exploit attempts must be logged. For each attempt, record:

- Timestamp (ISO-8601)
- Target URL/host
- Technique/payload used
- Result (success/failure/error)
- Finding ID if successful

Log location: `findings/exploit-log.jsonl`

Format:

```jsonl
{"ts": "2026-02-18T12:00:00Z", "target": "https://example.com/api/v1/users", "technique": "IDOR", "payload": "Changed user_id from 123 to 124", "result": "confirmed", "finding_id": "FINDING-001"}
```

## Rate Limiting

During exploitation:
- Max 1 request per second for manual testing
- Max 5 requests per second for automated replay
- Back off immediately on 429 responses
- Stop if WAF blocks researcher IP

## Scope Escape Prevention

- Verify scope before EVERY request (not just at phase start)
- Follow NO redirects automatically -- check redirect target is in scope
- If an exploit payload causes the application to make requests, ensure those requests target in-scope resources only
- SSRF PoCs: target known-safe internal endpoints (169.254.169.254, localhost) not production services

## When in Doubt

If uncertain whether a test is safe or within rules of engagement:

1. Stop the current exploitation attempt
2. Document what you were about to do
3. Ask the user for explicit permission
4. Only proceed with clear approval

False negatives (missing a finding) are acceptable. Program violations are not.
