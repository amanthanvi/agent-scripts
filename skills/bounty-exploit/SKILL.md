---
name: bounty-exploit
description: "Proof-of-concept development and evidence collection for triaged bug bounty findings. Reproduces vulnerabilities, captures evidence, and creates structured finding reports."
---

# Bug Bounty Exploit Phase

You are developing proof-of-concept exploits and collecting evidence for triaged bug bounty findings. This phase runs after triage and produces finding reports ready for writeup.

## Input

The engagement slug was passed from the bounty router. The engagement directory is at:
`~/engagement-kit/engagements/<slug>/`

## Pre-flight Checks

### 1. Phase Prerequisite

```bash
cd ~/engagement-kit && python3 lib/phase_state.py engagements/<slug>/ --check triage_complete
```

If exit code != 0, STOP. Inform user to run `/bounty triage <slug>` first.

### 2. Load Triage Report

Read `recon/triage-report.md` -- get ranked list of findings to exploit. Start with Confirmed, then Probable (by expected value descending).

### 3. Rules of Engagement

Read `admin/roe.md` for exploitation restrictions:
- Financial transaction limits
- Data modification rules (read-only vs write)
- Required request headers (e.g., `X-Bug-Bounty: True`)
- Testing hour restrictions
- Prohibited techniques

Read `references/exploit-safety.md` for safety guardrails.

## For Each Confirmed + Probable Finding

Process findings ranked by expected value (highest first).

### Step 1: Scope Check (MANDATORY per attempt)

```bash
cd ~/engagement-kit && python3 lib/scope_gate.py engagements/<slug>/ --check <target>
```

If scope check fails, SKIP the finding. Do not attempt exploitation on out-of-scope targets.

### Step 2: Reproduce

Replay the scan result manually to confirm the vulnerability exists:

```bash
curl -v -H "X-Bug-Bounty: True" <url> 2>&1 | tee evidence/http/<finding-slug>-request.txt
```

Or use hexstrike-ai `http_repeater` MCP tool for complex multi-step requests.

**If NOT reproducible**: mark as "not-reproducible" in `recon/triage-report.md` and SKIP to next finding.

### Step 3: Develop PoC

Craft minimal proof demonstrating impact. Guidance by vuln class:

| Vuln Class | PoC Goal | Technique |
|-----------|----------|-----------|
| XSS (reflected) | Trigger alert/DOM change | Craft payload, capture screenshot of execution |
| XSS (stored) | Demonstrate persistence | Inject, navigate away, return, capture screenshot |
| SQLi | Extract version info | `' UNION SELECT version()--`; NEVER dump user data |
| SSRF | Access internal resource | Request internal IP/metadata endpoint, capture response |
| IDOR | Access other user's data | Change ID parameter, show unauthorized access |
| Auth bypass | Demonstrate unauth access | Remove/modify auth token, show protected resource |
| Open redirect | Redirect to attacker domain | Craft URL, show redirect in response headers |
| RCE | Command output | `id` or `whoami` only; no destructive commands |

**Financial limits**: respect program limits. No transactions exceeding program-defined thresholds.

Read `references/exploit-safety.md` before every PoC.

### Step 4: Capture Evidence

For each confirmed finding, collect:

- **Screenshots**: use playwright `browser_take_screenshot` or browser-based capture
- **HTTP request/response**: full headers + body via `curl -v`
- **Network captures**: HAR files for complex multi-step exploits

Save to: `findings/FINDING-NNN-<slug>/evidence/`

Evidence integrity:

```bash
sha256sum <evidence-file> >> findings/FINDING-NNN-<slug>/evidence-manifest.jsonl
```

Format each line as: `{"file": "<filename>", "sha256": "<hash>", "timestamp": "<ISO-8601>"}`

Read `references/evidence-collection.md` for detailed capture patterns.

### Step 5: Create Finding Report

Create directory: `findings/FINDING-NNN-<slug>/`

**finding.md**:

```markdown
# FINDING-NNN: <Title>

## Metadata
- **Severity**: Critical/High/Medium/Low
- **CVSS 3.1**: X.X (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)
- **CWE**: CWE-XXX (<Name>)
- **Affected Asset**: <URL or host>
- **Status**: Confirmed

## Description
<1-2 paragraphs explaining the vulnerability>

## Steps to Reproduce
1. Navigate to ...
2. Modify parameter ...
3. Observe ...

## Impact
<What an attacker can ACTUALLY do -- concrete, not theoretical>

## Evidence
See `evidence-index.md` for full inventory.
- Screenshot: evidence/<filename>
- HTTP capture: evidence/<filename>

## Remediation
<Specific fix recommendation>
```

**evidence-index.md**:

```markdown
# Evidence Index -- FINDING-NNN

| # | File | Type | Description | SHA-256 |
|---|------|------|-------------|---------|
| 1 | screenshot-01.png | Screenshot | XSS payload execution | abc123... |
| 2 | request-01.txt | HTTP | Malicious request + response | def456... |
```

### Step 6: Impact Assessment

For each confirmed finding:

- Document what an attacker can ACTUALLY do (not theoretical worst-case)
- Calculate CVSS 3.1 score with specific vector string
- Note program-specific severity modifiers (from `engagement.yaml` or program policy)
- Estimate bounty range based on program's payout table

## Post-flight

### Update Hunting Session

Update `hunting-session.md` with:
- Confirmed findings table (title, severity, target, bounty estimate)
- Failed exploitation attempts table (finding, reason for failure)
- Total estimated bounty

### Set Phase Complete

```bash
cd ~/engagement-kit && python3 lib/phase_state.py engagements/<slug>/ --set exploit_complete
```

### Summary Report

```
## Exploit Complete: <program>

- Findings attempted: N
- Confirmed exploitable: N
- Not reproducible: N
- Total estimated bounty: $X,XXX - $X,XXX

Confirmed findings:
1. FINDING-001: <title> (CVSS X.X) -- est. $X,XXX
2. FINDING-002: <title> (CVSS X.X) -- est. $X,XXX

Next: run `/bounty writeup <slug>` (in a CLEAN context session)
```

## SAFETY INVARIANT

Before EVERY HTTP request during exploitation:

1. Scope check passes for the target
2. Required headers are present (from `admin/roe.md`)
3. No data modification beyond what's necessary for PoC
4. No access to other researchers' data
5. Stop immediately if encountering PII/sensitive data -- report finding without the data

```bash
cd ~/engagement-kit && python3 lib/scope_gate.py engagements/<slug>/ --check <TARGET>
```
